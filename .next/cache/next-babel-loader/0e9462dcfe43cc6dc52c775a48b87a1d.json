{"ast":null,"code":"import _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/shinoda/Desktop/LabApp/components/Fireadd.jsx\";\nvar __jsx = React.createElement;\nimport React, { Component } from 'react';\nimport firebase from 'firebase';\nimport 'firebase/storage';\nimport Router from 'next/router';\n\nvar Fireadd =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Fireadd, _Component);\n\n  function Fireadd(props) {\n    var _this;\n\n    _classCallCheck(this, Fireadd);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Fireadd).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"style\", {\n      heigth: '7em',\n      width: '350px',\n      lineHeight: '1.5em'\n    });\n\n    _this.state = {\n      msg_str: '',\n      lastID: -1,\n      data: []\n    };\n\n    _this.getLastID();\n\n    _this.doChangeMsg = _this.doChangeMsg.bind(_assertThisInitialized(_this));\n    _this.doAction = _this.doAction.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(Fireadd, [{\n    key: \"doChangeMsg\",\n    value: function doChangeMsg(e) {\n      this.setState({\n        msg_str: e.target.value\n      });\n    }\n  }, {\n    key: \"doAction\",\n    value: function doAction(e) {\n      this.addFireData();\n      Router.push('/contact_board');\n    } //最後のID取得\n\n  }, {\n    key: \"getLastID\",\n    value: function getLastID() {\n      var db = firebase.database();\n      var ref = db.ref('sample/');\n      var self = this;\n      ref.orderByKey().limitToLast(1).on(\"value\", function (snapshot) {\n        var res = snapshot.val();\n\n        for (var i in res) {\n          self.setState({\n            lastID: i\n          });\n          return;\n        }\n      });\n    }\n  }, {\n    key: \"addFireData\",\n    value: function addFireData() {\n      if (this.state.lastID == -1) {\n        return;\n      }\n\n      var id = this.state.lastID * 1 + 1;\n      var db = firebase.database();\n      var d = new Date().toString();\n      var month = (d.getMonth() + 1).toString(); // 月\n\n      var date = fillZero(d.getDate()); // 日\n\n      var hour = fillZero(d.getHours()); // 時\n\n      var minute = fillZero(d.getMinutes()); // 分\n\n      var second = fillZero(d.getSeconds()); // 秒\n\n      var str = year + month + date + hour + minute + second;\n      var ref = db.ref('/sample/' + id);\n      ref.set({\n        ID: id,\n        message: this.state.msg_str,\n        date: str\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      if (this.state.lastID == -1) {\n        this.getLastID();\n      }\n\n      return __jsx(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82\n        },\n        __self: this\n      }, __jsx(\"textarea\", {\n        style: this.style,\n        placeholder: \"type message....\",\n        onChange: this.doChangeMsg,\n        value: this.state.msg_str,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 83\n        },\n        __self: this\n      }), __jsx(\"button\", {\n        onClick: this.doAction,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }, \"\\u65B0\\u898F\\u6295\\u7A3F\"));\n    }\n  }]);\n\n  return Fireadd;\n}(Component);\n\nexport default Fireadd;","map":{"version":3,"sources":["/Users/shinoda/Desktop/LabApp/components/Fireadd.jsx"],"names":["React","Component","firebase","Router","Fireadd","props","heigth","width","lineHeight","state","msg_str","lastID","data","getLastID","doChangeMsg","bind","doAction","e","setState","target","value","addFireData","push","db","database","ref","self","orderByKey","limitToLast","on","snapshot","res","val","i","id","d","Date","toString","month","getMonth","date","fillZero","getDate","hour","getHours","minute","getMinutes","second","getSeconds","str","year","set","ID","message","style"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport firebase from 'firebase';\nimport 'firebase/storage';\nimport Router from 'next/router';\n\nclass Fireadd extends Component {\n\n    style = {\n        heigth:'7em',\n        width:'350px',\n        lineHeight: '1.5em'\n    }\n\n    constructor(props) {\n        super(props);\n        this.state = {\n            msg_str:'',\n            lastID: -1,\n            data: []\n        }\n        this.getLastID();\n        this.doChangeMsg = this.doChangeMsg.bind(this);\n        this.doAction = this.doAction.bind(this);\n    }\n\n    doChangeMsg(e) {\n        this.setState({\n            msg_str: e.target.value\n        })\n    }\n\n    doAction(e) {\n        this.addFireData();\n        Router.push('/contact_board');\n    }\n\n    //最後のID取得\n    getLastID() {\n        let db = firebase.database();\n        let ref = db.ref('sample/');\n        let self = this;\n        ref\n        .orderByKey()\n        .limitToLast(1)\n        .on(\"value\", snapshot => {\n            let res = snapshot.val();\n            for(let i in res) {\n                self.setState({\n                lastID: i\n                });\n                return;\n            }\n        });\n    }\n\n    addFireData() {\n        if (this.state.lastID == -1) {\n            return;\n        }\n        let id = this.state.lastID * 1 + 1;\n        let db = firebase.database();\n        let d = new Date().toString();\n        var month = (d.getMonth() + 1).toString(); // 月\n        var date = fillZero(d.getDate()); // 日\n        var hour = fillZero(d.getHours()); // 時\n        var minute = fillZero(d.getMinutes()); // 分\n        var second = fillZero(d.getSeconds()); // 秒\n        var str = year + month + date + hour + minute + second;\n        let ref = db.ref('/sample/' + id);\n        ref.set({\n            ID: id,\n            message: this.state.msg_str,\n            date: str\n        });\n    }\n\n    render() {\n        if(this.state.lastID == -1) {\n            this.getLastID();\n        }\n        return (\n            <div>\n                <textarea style={this.style} placeholder='type message....' onChange={this.doChangeMsg} value={this.state.msg_str} />\n                <button onClick={this.doAction}>\n                    新規投稿\n                </button>\n            </div>\n        );\n    }\n}\n\nexport default Fireadd;"]},"metadata":{},"sourceType":"module"}